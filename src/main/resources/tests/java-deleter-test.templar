package {database.package}.test.util;{\n}{\n}

// - - - - thoughtfully generated by synapticloop h2zero - - - - {\n}
//    with the use of synapticloop templar templating language{\n}
//              (tests/java-deleter-test.templar){\n}{\n}
{\n}
import static org.junit.Assert.*;{\n}
{\n}
import org.junit.Assert;{\n}
import org.junit.AfterClass;{\n}
import org.junit.BeforeClass;{\n}
import org.junit.Test;{\n}
import {database.package}.ConnectionManagerInitialiserOverride;{\n}
import com.synapticloop.h2zero.base.exception.H2ZeroFinderException;{\n}
import com.synapticloop.h2zero.base.manager.{options.database}.ConnectionManager;{\n}
{\n}
import java.sql.Connection;{\n}
import java.sql.SQLException;{\n}
import java.sql.*;{\n}
import java.util.ArrayList;{\n}
import java.util.List;{\n}
{\n}
{\n}
{loop database.tables as table}
	{if !table.isConstant}
import {database.package}.deleter.{table.javaClassName}Deleter;{\n}
	{endif}
{endloop}
{\n}
/**{\n}
 * WARNING NOTE: these tests are designed to test the generated SQL statements{\n}
 * __NOT__ whether the database actually returns sane results.{\n}
 * {\n}
 * These will also test to ensure that connections are setting closed properly{\n}
 * so that there ar no resource leakages.{\n}
 */{\n}
{\n}
public class DeleterTest extends DatabaseSetupTest {{{\n}
{\n}

{loop database.tables as table}
	{if !table.isConstant}
{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteByPrimaryKey() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteByPrimaryKey(1L).execute());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteByPrimaryKeySilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteByPrimaryKey(1L).executeSilent());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteByPrimaryKeyWithConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteByPrimaryKey(1L).withConnection(connection).execute());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteByPrimaryKeyWithConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteByPrimaryKey(1L).withConnection(connection).executeSilent());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  The delete all deleters

  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteAll() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteAll().execute());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteAllSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteAll().executeSilent());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteAllWithConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteAll().withConnection(connection).execute());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}DeleteAllWithConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.deleteAll().withConnection(connection).executeSilent());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

	{endif}
{endloop}

{loop database.tables as table}
	{if !table.isConstant}
		{loop table.deleters as deleter}
{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).execute());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}Silent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).executeSilent());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{if fn:notEqual[options.database, "sqlite3"]}
{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}WithLimit() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).withLimit(0).execute();{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}WithLimitSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).withLimit(0).executeSilent());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}
{endif}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}WithConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()){{{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).withConnection(connection).execute());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}WithConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()){{{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).withConnection(connection).executeSilent());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{if fn:notEqual[options.database, "sqlite3"]}
{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}WithConnectionLimit() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()){{{\n}
{\t}// ::{deleter.whereFields.size}::{\n}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).withConnection(connection).withLimit(0).execute());{\n}

{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{deleter.name}WithConnectionLimitSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()){{{\n}
{\t}{\t}{\t}Assert.assertEquals(-1, {table.javaClassName}Deleter.{deleter.name}({import classpath:/tests/snippet/deleter-field-params.templar}).withConnection(connection).withLimit(0).execute());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}
{endif}
		{endloop}
	{endif}
{endloop}

}{\n}