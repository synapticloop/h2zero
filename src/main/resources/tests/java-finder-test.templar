package {database.package}.test.util;{\n}{\n}

// - - - - thoughtfully generated by synapticloop h2zero - - - - {\n}
//    with the use of synapticloop templar templating language{\n}
//               (tests/java-finder-test.templar){\n}{\n}
{\n}
import static org.junit.Assert.*;{\n}
{\n}
import org.junit.Assert;{\n}
import org.junit.AfterClass;{\n}
import org.junit.BeforeClass;{\n}
import org.junit.Test;{\n}
import {database.package}.ConnectionManagerInitialiserOverride;{\n}
import com.synapticloop.h2zero.base.manager.{options.database}.ConnectionManager;{\n}
{\n}
import java.sql.Connection;{\n}
import java.sql.SQLException;{\n}
import java.util.ArrayList;{\n}
import java.sql.*;{\n}
import java.util.List;{\n}
{\n}
{\n}
{loop database.tables as table}
import {database.package}.finder.{table.javaClassName}Finder;{\n}
{endloop}
{\n}
/**{\n}
 * WARNING NOTE: these tests are designed to test the generated SQL statements{\n}
 * __NOT__ whether the database actually returns sane results.{\n}
 * {\n}
 * These will also test to ensure that connections are setting closed properly{\n}
 * so that there are no resource leakages.{\n}
 */{\n}
{\n}
public class FinderTest extends DatabaseSetupTest {{{\n}
{\n}

{loop database.tables as table}
{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindByPrimaryKey() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}// this shouldn't find anything - and we don't care - only about SQLExceptions{\n}
{\t}{\t}{table.javaClassName}Finder.findByPrimaryKey(1L).execute();{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{--
  Constants may very well return a result...
}
{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindByPrimaryKeySilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}Assert.assertNull({table.javaClassName}Finder.findByPrimaryKey(-831486134981L).executeSilent());{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindByPrimaryKeyWithConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}{table.javaClassName}Finder.findByPrimaryKey(1L).withConnection(connection).execute();{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindByPrimaryKeyWithConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}Assert.assertNull({table.javaClassName}Finder.findByPrimaryKey(-831486134981L).withConnection(connection).executeSilent());{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	FIND ALL TESTING METHODS

  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAll() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}

{if table.isConstant}
{\t}{\t}Assert.assertEquals({table.constants.size}, {table.javaClassName}Finder.findAll().execute().size());{\n}
{else}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll().execute().size());{\n}
{endif}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllLimitOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}

{if table.isConstant}
{\t}{\t}Assert.assertEquals(1, {table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}.withLimit(1){\n}
{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}.execute(){\n}
{\t}{\t}{\t}.size());{\n}
{else}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}.withLimit(1){\n}
{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}.execute(){\n}
{\t}{\t}{\t}.size());{\n}
{endif}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}



{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}

{if table.isConstant}
{\t}{\t}Assert.assertEquals({table.constants.size}, {table.javaClassName}Finder.findAll().executeSilent().size());{\n}
{else}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll().executeSilent().size());{\n}
{endif}

{\n}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllLimitOffsetSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}

{if table.isConstant}
{\t}{\t}Assert.assertEquals(1, {table.javaClassName}Finder.findAll().withLimit(1).withOffset(0).executeSilent().size());{\n}
{else}
{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll().withLimit(1).withOffset(0).executeSilent().size());{\n}
{endif}

{\n}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{if table.isConstant}
{\t}{\t}{\t}Assert.assertEquals({table.constants.size}, {table.javaClassName}Finder.findAll().withConnection(connection).execute().size());{\n}
{else}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll().withConnection(connection).execute().size());{\n}
{endif}

{\t}{\t}}{\n}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{if table.isConstant}
{\t}{\t}{\t}Assert.assertEquals({table.constants.size}, {table.javaClassName}Finder.findAll().withConnection(connection).executeSilent().size());{\n}
{else}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll().withConnection(connection).executeSilent().size());{\n}
{endif}

{\t}{\t}}{\n}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}



{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnectionLimit() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{if table.isConstant}
{\t}{\t}{\t}Assert.assertEquals(1, {table.javaClassName}Finder.findAll().withConnection(connection).withLimit(1).withOffset(0).execute().size());{\n}
{else}
{\t}{\t}{\t}{table.javaClassName}Finder.findAll().withConnection(connection).withLimit(1).withOffset(0).execute();{\n}
{endif}
{\t}{\t}}{\n}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnectionLimitSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{if table.isConstant}
{\t}{\t}{\t}Assert.assertEquals(1, {table.javaClassName}Finder.findAll().withConnection(connection).withLimit(1).withOffset(0).executeSilent().size());{\n}
{else}
{\t}{\t}{\t}Assert.assertEquals(0, {table.javaClassName}Finder.findAll().withConnection(connection).withLimit(1).withOffset(0).executeSilent().size());{\n}
{endif}

{\t}{\t}}{\n}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}




{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnectionOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{if table.isConstant}
{\t}{\t}{\t}Assert.assertEquals({table.constants.size}, {table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.withLimit(null){\n}
{\t}{\t}{\t}{\t}.withOffset(1){\n}
{\t}{\t}{\t}{\t}.execute(){\n}
{\t}{\t}{\t}{\t}.size());{\n}
{else}
{\t}{\t}{\t}{table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.withLimit(null){\n}
{\t}{\t}{\t}{\t}.withOffset(1){\n}
{\t}{\t}{\t}{\t}.execute();{\n}
{endif}

{\t}{\t}{\t}Assert.fail("A SQL Exception should have been thrown as there was an offset without a limit set.");

{\t}{\t}} catch(SQLException ignored) {{{\n}
{\t}{\t}}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnectionOffsetSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{\t}{\t}{\t}{table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.withLimit(null){\n}
{\t}{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}{\t}.executeSilent();{\n}
{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithConnectionLimitOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}

{if table.isConstant}
{\t}{\t}{\t}Assert.assertEquals(1, {table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.withLimit(1){\n}
{\t}{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}{\t}.execute(){\n}
{\t}{\t}{\t}{\t}.size());{\n}

{else}
{\t}{\t}{\t}{table.javaClassName}Finder.findAll(){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.withLimit(1){\n}
{\t}{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}{\t}.execute();{\n}
{endif}

{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}FindAllWithNullConnectionLimitOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{if table.isConstant}
{\t}{\t}Assert.assertEquals(1, {table.javaClassName}Finder.findAll().withConnection(null).withLimit(1).withOffset(0).execute().size());{\n}
{else}
{\t}{\t}{table.javaClassName}Finder.findAll().withConnection(null).withLimit(1).withOffset(0).execute();{\n}
{endif}

{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}

{\n}

{endloop}

{-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	Now for the user finders

  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
{loop database.tables as table}
	{loop table.finders as finder}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}).execute();{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}Silent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}).executeSilent();{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{if !finder.unique}
{-- UNIQUE FINDERS DO NOT HAVE LIMITS/OFFSET }
{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}LimitOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}).withLimit(0).withOffset(0).execute();{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}LimitOffsetSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}{\t}.withLimit(0){\n}
{\t}{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}{\t}.executeSilent();{\n}
{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{endif}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.execute();{\n}
{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}try (Connection connection = ConnectionManager.getConnection()) {{{\n}
{\t}{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}{\t}.withConnection(connection){\n}
{\t}{\t}{\t}{\t}.executeSilent();{\n}
{\n}
{\t}{\t}}{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithNullConnection() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}.withConnection(null){\n}
{\t}{\t}{\t}.execute();{\n}
{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithNullConnectionSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}{\t}.withConnection(null){\n}
{\t}{\t}{\t}{\t}.executeSilent();{\n}
{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}




{if !finder.unique}
{-- UNIQUE FINDERS DO NOT HAVE LIMITS/OFFSET }

{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithNullConnectionLimitOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}.withConnection(null){\n}
{\t}{\t}{\t}.withLimit(0){\n}
{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}.execute();{\n}
{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithNullConnectionLimitOffsetSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}{\t}.withConnection(null){\n}
{\t}{\t}{\t}{\t}.withLimit(0){\n}
{\t}{\t}{\t}{\t}.withOffset(0){\n}
{\t}{\t}{\t}{\t}.executeSilent();{\n}
{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}



{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithNullConnectionNullLimitNullOffset() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}.withConnection(null){\n}
{\t}{\t}{\t}.withLimit(null){\n}
{\t}{\t}{\t}.withOffset(null){\n}
{\t}{\t}{\t}.execute();{\n}
{\n}
{\t}{\t}Assert.assertEquals(numConnections, ConnectionManager.getComboPooledDataSource().getNumConnections());{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}


{\t}@Test{\n}
{\t}public void test{table.javaClassName}{finder.name}WithNullConnectionNullLimitNullOffsetSilent() throws SQLException {{{\n}
{\t}{\t}int numConnections = ConnectionManager.getComboPooledDataSource().getNumConnections();{\n}
{\t}{\t}int numBusyConnections = ConnectionManager.getComboPooledDataSource().getNumBusyConnections();{\n}
{\t}{\t}{table.javaClassName}Finder.{finder.name}({import classpath:/tests/snippet/finder-field-params.templar}){\n}
{\t}{\t}{\t}{\t}.withConnection(null){\n}
{\t}{\t}{\t}{\t}.withLimit(null){\n}
{\t}{\t}{\t}{\t}.withOffset(null){\n}
{\t}{\t}{\t}{\t}.executeSilent();{\n}
{\n}
{\t}{\t}// need to sleep to ensure that the connection has time to close - hacky... :({\n}
{\t}{\t}try {{ Thread.sleep(1); } catch (InterruptedException e) {{ /* do nothing */ }{\n}
{\t}{\t}Assert.assertEquals(numBusyConnections, ConnectionManager.getComboPooledDataSource().getNumBusyConnections());{\n}
{\t}}{\n}
{\n}
{endif}
	{endloop}
{endloop}


{-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	Now for the user finders with a select clause

	these are subtly different as they return a bean or a list of beans, but
	the same

  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -}
{loop database.tables as table}
	{loop table.finders as finder}
		{if fn:notNull[finder.selectClause]}
		{endif}
	{endloop}
{endloop}


}{\n}